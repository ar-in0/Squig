<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EasyRTMP: EasyRTMP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">EasyRTMP
   </div>
   <div id="projectbrief">Simple RTMP library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">EasyRTMP</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Lightweight RTMP client/server library</p>
<h1><a class="anchor" id="autotoc_md1"></a>
About RTMP</h1>
<p>This is old standard, originally developed in 2003 as a proprietary protocol for streaming between a <em>Flash player</em> and a server. In 2012 <em>Adobe</em> released <a href="https://www.adobe.com/devnet/rtmp.html">specification</a>. Protocol is designed to stream low latency realtime data. Today, when Flash is dead, but <b>RTMP is de-facto standard for media streaming for first-mile delivery</b> (from streamer to server). Protocol can be used to transfer any data, but in media world it is used to stream <b>FLV packets</b>, often <b>AAC</b> audio with <b>H264</b> video. Codec parameters are exchanged via <em>ActionScript</em> messages. Many say that RTMP is old and does not support new formats 4K HDR 10bit video, but actually protocol supports everything. New formats are not supported by agreements and <em>FLV specification</em>. During writing library I found that some software and services violates or work differently with protocol. Facebook violates some AMF serialization. YouTube accepted streams even without codec parameters, but warn about 65k x 65k resolution. Twitch required correct composition_offset parameter in video packets, or video jitters, while YouTube playbacks smoothly. XSplit sends AMF codec data not as numbers defined in FLV specification but as text. All this stuff I commented in code. So, you can easily stream with new formats as long as client and server have an agreement about format exchange.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
About library</h1>
<p>Library is splitted to 3 parts: <b>transport, protocol, media streaming</b>.</p>
<p><b>Protocol</b> contains communicating logic between two peers.</p>
<p><b>Transport</b> contains logic for lower data transport and layering, such as TLS. Library contains TCP client/server Windows/Linux transport and OpenSSL TLS.</p>
<p><b>Media streaming</b> contains logic of media streaming. Is compatible with the most of streaming services and software. You can use this to build media server or client applications. Actually RTMP is bidirectional protocol so it can be used to stream media in both directions.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Documentation</h1>
<p>The most important code is documented with doxygen.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Dependencies</h1>
<ul>
<li>C++11 compiler (tested on MSVCv14.29, gcc 8.3.0)</li>
<li>OpenSSL (optional, to support RTMPS)</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Building</h1>
<p>Project has CMake build script</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Example server</h1>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacelibrtmp.html">librtmp</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//start tcp server on port 1935</span></div>
<div class="line"><a class="code hl_class" href="class_t_c_p_server.html">TCPServer</a> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">tcp_server</a>(1935);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//accept connection</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">client</a> = <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">tcp_server</a>.accept();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//initialize endpoint and server session</span></div>
<div class="line"><a class="code hl_class" href="classlibrtmp_1_1_r_t_m_p_endpoint.html">RTMPEndpoint</a> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">rtmp_endpoint</a>(<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">client</a>.get());</div>
<div class="line"><a class="code hl_class" href="classlibrtmp_1_1_r_t_m_p_server_session.html">RTMPServerSession</a> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">server_session</a>(&amp;<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">rtmp_endpoint</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span>{</div>
<div class="line">   <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line">      <span class="comment">//receive media message</span></div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">message</a> = <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">server_session</a>.GetRTMPMessage();</div>
<div class="line">      <span class="comment">//get received media codec parameters and streaming key</span></div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">params</a> = <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">server_session</a>.GetClientParameters();</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">message</a>.message_type){            </div>
<div class="line">         <span class="keywordflow">case</span> RTMPMessageType::VIDEO:</div>
<div class="line">            <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">HandleVideo</a>(<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">message</a>,<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">params</a>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">         <span class="keywordflow">case</span> RTMPMessageType::AUDIO:</div>
<div class="line">            <a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">HandleAudio</a>(<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">message</a>,<a class="code hl_function" href="framework_8h.html#a460b680006c343119f84e21be3a4351a">params</a>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">   }</div>
<div class="line">}<span class="keywordflow">catch</span>(...){</div>
<div class="line">   <span class="comment">//connection terminated by peer or network conditions</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_t_c_p_server_html"><div class="ttname"><a href="class_t_c_p_server.html">TCPServer</a></div><div class="ttdef"><b>Definition</b> tcp_network.h:50</div></div>
<div class="ttc" id="aclasslibrtmp_1_1_r_t_m_p_endpoint_html"><div class="ttname"><a href="classlibrtmp_1_1_r_t_m_p_endpoint.html">librtmp::RTMPEndpoint</a></div><div class="ttdef"><b>Definition</b> rtmp_endpoint.h:59</div></div>
<div class="ttc" id="aclasslibrtmp_1_1_r_t_m_p_server_session_html"><div class="ttname"><a href="classlibrtmp_1_1_r_t_m_p_server_session.html">librtmp::RTMPServerSession</a></div><div class="ttdef"><b>Definition</b> rtmp_server_session.h:12</div></div>
<div class="ttc" id="aframework_8h_html_a460b680006c343119f84e21be3a4351a"><div class="ttname"><a href="framework_8h.html#a460b680006c343119f84e21be3a4351a">_ntohs</a></div><div class="ttdeci">T _ntohs(T t)</div><div class="ttdef"><b>Definition</b> framework.h:11</div></div>
<div class="ttc" id="anamespacelibrtmp_html"><div class="ttname"><a href="namespacelibrtmp.html">librtmp</a></div><div class="ttdef"><b>Definition</b> rtmp_client_session.h:7</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Other examples</h1>
<p>Examples are available in next products: <a href="https://github.com/AlexanderBabansky/RTMP2NDI">RTMP2NDI</a>, <a href="https://github.com/AlexanderBabansky/RTMP-Restreamer">RTMP-Restreamer</a></p>
<h1><a class="anchor" id="autotoc_md8"></a>
Acknowledgements</h1>
<ul>
<li><a href="https://www.openssl.org">OpenSSL</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
